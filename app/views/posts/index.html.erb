<div class="top-image"></div>

<div class="latestposts display-5 text-center mt-5 mb-5">Posts</div>
<div class="card-container">
  <% @posts.each do |t| %>
    <div class="card mb-5" style="width: 18rem;">
      <%= link_to(post_path(t.id),class:'text-decoration-none text-success') do %>
        <div class="card-header card-title"><%= t.title %></div>
        <% if t.images.exists? && t.images[0]  %>
            <%= image_tag t.images[0], class: "card-img-top" %>
        <% else %>
          <%= image_tag "noimage.png",class: "card-img-top"  %>
        <% end %>
      <% end %>
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center card-body-footer">
          <div class="btn-group">
            <%= link_to "detail", post_path(t.id) ,class: "btn btn-sm btn-outline-secondary" %>
            <% if user_signed_in? %>
              <% if current_user.id == t.user_id %>
                <%= link_to "edit", edit_post_path(t.id) ,class: "btn btn-sm btn-outline-secondary" %>
                <%= button_to "delete", post_path(t.id), method: :delete ,data: {confirm: "Do you want to delete it?"},class: "btn btn-sm btn-outline-secondary" %>
              <% elsif current_user.admin? %>
                <%= link_to "edit", edit_post_path(t.id),class: "btn btn-sm btn-outline-secondary" %>
                <%= button_to "delete", post_path(t.id), method: :delete ,data: {confirm: "Do you want to delete it?"},class: "btn btn-sm btn-outline-secondary" %>
              <% end %>
            <% end %>
          </div>
          <% if (@now - t.created_at) <= 60 * 60 %>
            <small class="text-muted"><%=((@now - t.created_at) / 60).to_i.to_s + "分前" %></small>
          <% elsif (@now - t.created_at) <= 60 * 60 * 24 %>
            <small class="text-muted"><%=((@now - t.created_at) / 3600).to_i.to_s + "時間前" %></small>
          <% elsif (@today - t.created_at.to_date) <= 30 %>
            <small class="text-muted"><%= (@today - t.created_at.to_date).to_i.to_s + "日前" %></small>
          <% else %>
            <small class="text-muted"><%= t.created_at.strftime('%Y-%m-%d') %></small>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>

<%= paginate @posts %>

<br><br><br>
<h1>ここから下は作業場所</h1>
<br><br><br>
<% if user_signed_in? %>
<%= current_user.email %>でログイン中<br>
<%# if current_user.is_professor? %>
<%= @points_sum %>/5.0点（残り<%= 5.0- @points_sum %>点）</br>
<% @comments.each do |t| %>
  <%= t.post.user.email %>に<%= t.point %>点</br>
    <% end %>
    <%# end %>
    <% end %>

<%= link_to(new_post_path) do %>
  <i class="fa-solid fa-circle-plus fa-4x text-success"></i>
<% end %>
<br><br><br>